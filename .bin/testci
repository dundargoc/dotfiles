#!/usr/bin/env python3

import subprocess
import os
import sys


def main():
    repo_path = subprocess.check_output(
        ["git", "rev-parse", "--show-toplevel"], text=True
    ).strip()
    HOME = os.environ["HOME"]

    if repo_path not in [f"{HOME}/programs/dundar-organization/neovim"]:
        sys.exit("Attempting VERY dangerous command outsite of intended area. Abort")

    subprocess.call(["testclean"])

    expected_outcome = "\n".join(
        [
            "Expected outcome:",
            "1. `diagnostic` label applied due to type",
            "2. gpanders assigned as reviewer",
        ]
    )
    subprocess.call(["testpr", "--type", "diagnostic", "--body", expected_outcome])


if __name__ == "__main__":
    main()
